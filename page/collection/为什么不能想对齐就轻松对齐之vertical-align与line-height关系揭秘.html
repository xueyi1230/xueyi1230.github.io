<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.4 (452971)"/><meta name="author" content="唐 一"/><meta name="created" content="2016-03-08 16:07:41 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2016-03-09 09:11:31 +0000"/><title>为什么不能想对齐就轻松对齐之vertical-align与line-height关系揭秘</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div>需要是HTML5文档声明</div><div><hr/></div><div><span style="font-size: 24px;">遇到了什么问题</span></div><div><br/></div><div>&lt;!-- div里有一个普通的img --&gt;<br/>
&lt;div&gt;&lt;img src="http://hangjia.qiniudn.com/Fi0DrupdmIIs4cMyKy30jKiBYiWV"&gt;&lt;/div&gt;</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/8B617ABE-0F53-456F-AEA9-AFF51E862F9F.png" height="254" width="620"/></div><div>和谐，美好……</div><div>但是！！</div><div>为div加上background之后</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/275ACC09-BC3A-4C06-8144-988CAB31C28B.png" height="250" width="620"/></div><div>迷之间隔出现了！</div><div><br/></div><div><div><span style="font-size: 24px;">分析一下现象</span></div><div><br/></div><div>&lt;!-- 在普通的img后加上inline-block<font color="#DE5700">（为什么非要inline-block？？一会说到）</font>的文字 --&gt;<br/>
&lt;div&gt;&lt;img src="http://hangjia.qiniudn.com/Fi0DrupdmIIs4cMyKy30jKiBYiWV"&gt;&lt;span&gt;x加上inline-block的文字y&lt;/span&gt;&lt;/div&gt;</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/EC10060C-683D-49D9-A473-862F3CFE83EA.png" height="247" width="1171"/></div><div><br/></div><div><span style="font-size: 24px;">究其原因</span></div><div><br/></div><div style="font-size: 19px;">辅助知识1、两种盒模型：inline boxes，line boxes</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/158C2A45-F1C4-427A-80E3-238A095B136C.png" height="136" width="546"/></div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/03EC8B20-FF5B-4321-96D1-0632B7A76C8C.png" height="107" width="463"/></div><div><br/></div>
在块状元素内部，每个line boxes从一个 <span style="font-size: 24px;">strut&nbsp;&nbsp;</span>开始，它是一个没有实体的inline boxes，它的高度由父级块所指定的。</div><div style="font-size: 19px;">---------------------------------------------------------------------------------------</div><div style="font-size: 19px;">辅助知识2、vertical-align与line-height的关系</div><div><p style="margin: 16px 0px; padding: 0px; list-style: none; color: rgb(51, 51, 51); font-family: Arial; font-size: 16px; line-height: 24px; text-align: justify; widows: 1; background-color: rgb(255, 255, 255);"><code style="border: 1px solid rgb(234, 234, 234); border-radius: 3px; padding: 0px 4px; margin-left: 2px; margin-right: 2px; font-family: Consolas, monospace; background-color: rgb(248, 248, 248);">vertical-align</code>的百分比值不是相对于字体大小或者其他什么属性计算的，而是相对于<code style="border: 1px solid rgb(234, 234, 234); border-radius: 3px; padding: 0px 4px; margin-left: 2px; margin-right: 2px; font-family: Consolas, monospace; background-color: rgb(248, 248, 248);">line-height</code>计算的。举个简单的例子，如下CSS代码：</p><div style="color: rgb(51, 51, 51); font-family: Arial; font-size: 16px; line-height: 24px; text-align: justify; widows: 1; background-color: rgb(255, 255, 255);"><pre style="padding: 10px; margin-top: 5px; margin-bottom: 5px; font-size: 13px; border: 1px dashed rgb(204, 204, 204); zoom: 1; color: rgb(0, 0, 255); white-space: pre-wrap; word-wrap: break-word; font-family: &amp;apos;Lucida Console&amp;apos;, Consolas, Monaco; background-color: rgba(0, 0, 0, 0.0664063); background-position: initial initial; background-repeat: initial initial;">
{
  line-height: 30px;
  vertical-align: -10%;
}
</pre></div><p style="margin: 16px 0px; padding: 0px; list-style: none; color: rgb(51, 51, 51); font-family: Arial; font-size: 16px; line-height: 24px; text-align: justify; widows: 1; background-color: rgb(255, 255, 255);">实际上，等同于：</p><div style="color: rgb(51, 51, 51); font-family: Arial; font-size: 16px; line-height: 24px; text-align: justify; widows: 1; background-color: rgb(255, 255, 255);"><pre style="padding: 10px; margin-top: 5px; margin-bottom: 5px; font-size: 13px; border: 1px dashed rgb(204, 204, 204); zoom: 1; color: rgb(0, 0, 255); white-space: pre-wrap; word-wrap: break-word; font-family: &amp;apos;Lucida Console&amp;apos;, Consolas, Monaco; background-color: rgba(0, 0, 0, 0.0664063); background-position: initial initial; background-repeat: initial initial;">
{
  line-height: 30px;
  vertical-align: <span style="color: rgb(205, 0, 0);">-3px;</span>    <span style="color: green;">/* = 30px * -10% */</span>  
}
</pre></div></div><div><br/></div><div>-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/E997345C-8131-4C08-BF9E-9E0A77EC69DF.png" height="104" width="192"/></div><div>1、<font color="#E30000">vertical-align</font>默认值是baseline</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;baseline 就是x的底边 </div><div>2、文字的高度是由（父级块的）<font color="#E30000">line-height</font>决定的</div><div><br/></div><div><div><span style="font-size: 24px;">解决方法</span></div><div>1. 让vertical-align失效<br/>
图片默认是inline水平的，而vertical-align对块状水平的元素无感。因此，我们只要让图片display水平为block就可以了，我们可以直接设置display或者浮动、绝对定位等（如果布局允许）。</div><div>2. 使用其他vertical-align值<br/>
告别baseline, 取用其他属性值，比方说bottom/middle/top都是可以的。</div><div>---------------------------------------------------------------------</div><div>3. 直接修改line-height值<br/>
下面的空隙高度，实际上是文字计算后的行高值和字母x下边缘的距离。因此，只要行高足够小，实际文字占据的高度的底部就会在x的上面，下面没有了高度区域支撑，自然，图片就会有容器底边贴合在一起了。比方说，我们设置行高10像素：</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/E2D41438-EED7-4033-B16C-D22E821989EF.png" height="219" width="1175"/></div><div>4. 使用font-size间接控制<br/>
line-height是相对单位，也可以使用font-size间接控制，例如line-height:0.5或者line-height:160%之类，font-size设为0, 本质上还是改变line-height值.</div><div><br/></div><div><span style="font-size: 24px;">应用</span></div>
借助vertical-align与line-height完成垂直居中：</div><div>div { line-height: 300px; }<br/>
img { vertical-align: middle; }</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/ED747E4B-9AAA-4772-A995-7E57EC462204.png" height="336" width="1200"/></div><div>并没有垂直居中……</div><div>因为<img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/393A0116-AC8D-4036-9179-7A034C0B4240.png" height="158" width="237"/></div><div>因此，要想完全垂直居中，最先想到的方法就是让后面的&nbsp;&nbsp;<span style="font-size: 24px;">strut&nbsp;&nbsp;</span>也是vertical-align:middle，然而，&nbsp;&nbsp;<span style="font-size: 24px;">strut&nbsp;&nbsp;</span>不会受非继承特性的属性影响，所以，根本没法设置vertical-align:middle，除非你自己创建一个显示的内联元素。</div><div><br/>
但&nbsp;&nbsp;<span style="font-size: 24px;">strut&nbsp;&nbsp;</span>受具有继承特性的CSS属性影响，于是，我们可以通过其他东西来做调整，让字符的中线和字符内容中心线在一起，或者说在一个位置上就可以了。</div><div><br/></div><div>为了使中线重合，我们设置font-size: 0;</div><div><img src="%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E8%83%BD%E6%83%B3%E5%AF%B9%E9%BD%90%E5%B0%B1%E8%BD%BB%E6%9D%BE%E5%AF%B9%E9%BD%90%E4%B9%8Bvertical-align%E4%B8%8Eline-height%E5%85%B3%E7%B3%BB%E6%8F%AD%E7%A7%98.resources/503D4728-2187-458D-B991-D40F906F42A5.png" height="311" width="691"/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-size: 24px;">参考阅读</span></div><div>CSS深入理解vertical-align和line-height的基友关系：<a href="http://www.zhangxinxu.com/wordpress/?p=4925"/><a href="http://www.zhangxinxu.com/wordpress/?p=4925">http://www.zhangxinxu.com/wordpress/?p=4925</a></div><div>css-float浮动的深入研究、详解及拓展一：<a href="http://www.zhangxinxu.com/wordpress/?p=583">http://www.zhangxinxu.com/wordpress/?p=583</a></div><div>why the span's line-height is useless：<a href="http://stackoverflow.com/questions/11829393/why-the-spans-line-height-is-useless#answer-11841648">http://stackoverflow.com/questions/11829393/why-the-spans-line-height-is-useless#answer-11841648</a></div></body></html>